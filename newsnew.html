<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>×¦'××˜ AI ×™×©×¨××œ×™</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #f0f4f8;
      font-family: 'Heebo', sans-serif;
    }
    .chat-bubble {
      max-width: 70%;
      padding: 10px 15px;
      border-radius: 18px;
      margin-bottom: 10px;
    }
    .user-bubble {
      background-color: #d1f5d3;
      align-self: flex-end;
    }
    .bot-bubble {
      background-color: #e2e8f0;
      align-self: flex-start;
    }
  </style>
</head>
<body class="flex flex-col h-screen p-4">
  <h1 class="text-2xl font-bold mb-4 text-center">ğŸ¤– ×¦'××˜ AI ×™×©×¨××œ×™</h1>

  <div id="chat" class="flex flex-col flex-grow overflow-y-auto bg-white p-4 rounded shadow-inner space-y-2"></div>

  <form id="chat-form" class="mt-4 flex">
    <input id="prompt" type="text" class="flex-grow p-2 border rounded" placeholder="××” ×ª×¨×¦×” ×œ×©××•×œ?" required />
    <button type="submit" class="ml-2 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">×©×œ×—</button>
  </form>

  <input type="file" id="fileInput" class="mt-4 text-sm" />
  <button onclick="localStorage.removeItem('chatHistory'); location.reload();" class="mt-2 text-sm text-red-600 hover:underline">
    ğŸ—‘ï¸ × ×§×” ×©×™×—×”
  </button>

  <script>
    const chat = document.getElementById('chat');
    const form = document.getElementById('chat-form');
    const promptInput = document.getElementById('prompt');
const apiKey = 'AIzaSyBXd993D827L4-VFtad7bnI7o_Kxq-_yqk';

    let chatHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');

    function loadHistory() {
      chatHistory.forEach(msg => addMessage(msg.text, msg.sender));
    }

    function saveToHistory(text, sender) {
      chatHistory.push({ text, sender });
      localStorage.setItem('chatHistory', JSON.stringify(chatHistory));
    }

    function addMessage(text, sender) {
      const bubble = document.createElement('div');
      bubble.className = `chat-bubble ${sender === 'user' ? 'user-bubble self-end' : 'bot-bubble self-start'}`;
      bubble.textContent = text;
      chat.appendChild(bubble);
      chat.scrollTop = chat.scrollHeight;
      saveToHistory(text, sender);
    }

    async function sendMessage(promptText) {
      addMessage(promptText, 'user');
      const response = await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=" + apiKey, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          contents: [{ role: "user", parts: [{ text: promptText }] }]
        })
      });

      const data = await response.json();
      const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || "âŒ ×œ× ×”×ª×§×‘×œ×” ×ª×©×•×‘×” ××”-AI";
      addMessage(aiResponse, 'bot');
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const prompt = promptInput.value.trim();
      if (!prompt) return;
      promptInput.value = '';
      await sendMessage(prompt);
    });

    document.getElementById('fileInput').addEventListener('change', async function () {
      const file = this.files[0];
      if (!file) return;
      const text = await file.text();
      promptInput.value = text.slice(0, 1000);
    });

    window.onload = loadHistory;
  </script>
</body>
</html>

